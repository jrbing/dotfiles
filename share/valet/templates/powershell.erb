#requires -version 4
<#

    .SYNOPSIS
        <Overview of script>

    .DESCRIPTION
        <Brief description of script>

    .PARAMETER <Parameter_Name>
        <Brief description of parameter input required. Repeat this attribute if required>

    .NOTES
        Version:        1.0
        Author:         JR Bing
        Creation Date:  <%= @date %>
        Purpose/Change: Initial script development

    .EXAMPLE
        <Example goes here. Repeat this attribute for more than one example>

#>


#---------------------------------------------------------[Initialisations]--------------------------------------------------------

# Valid values: "Stop", "Inquire", "Continue", "Suspend", "SilentlyContinue"
$ErrorActionPreference = "Inquire"
$DebugPreference = "Continue"
$VerbosePreference = "Continue"

#----------------------------------------------------------[Declarations]----------------------------------------------------------

#$sScriptVersion = "1.0"

#-----------------------------------------------------------[Functions]------------------------------------------------------------
#
Function Log-Info {
    Param ([Parameter(Mandatory=$true)][string]$Message)
    Process {
        Write-Host "INFO: $Message  " -Fore DarkYellow
    }
}

Function Log-Error {
    Param (
            [Parameter(Mandatory=$true)][string]$Message,
            [Parameter(Mandatory=$false)][boolean]$ExitGracefully
          )
    Process {
        Write-Warning -Message "Error: An error has occurred [$ErrorDesc]."
        If ($ExitGracefully -eq $True){
            Break
        }
    }
}

Function Example-Function{
    Param()
    Begin {
        Log-Info -Message "Entering..."
    }
    Process {
        Try {
            Log-Info -Message "Executing..."
        }
        Catch {
            Log-Error -Message $_.Exception -ExitGracefully $True
            Break
        }
    }
    End {
        If($?) {
            Log-Info -Message "Completed Successfully."
        }
    }
}

#-----------------------------------------------------------[Execution]------------------------------------------------------------

# Script execution goes here
Example-Function
