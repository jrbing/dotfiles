#!/usr/bin/env casperjs

/*
 * Name: <%= @script_name %>.js
 * Description: 
 * Author: 
 *
 */

'use strict';

var url = 'http://example.com/login';
var username = 'user';
var password = 'pass';

var casper = require('casper').create({
  verbose: true,
  logLevel: 'debug',
  pageSettings: {
    loadImages: false,
    loadPlugins: false,
    userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4'
  }
});

casper.on('remote.message', function(msg) {
  this.echo('remote message caught: ' + msg);
});

casper.on("page.error", function(msg, trace) {
  this.echo("Page Error: " + msg, "ERROR");
});

/***********
 *  Login  *
 ***********/

casper.start(url, function() {
  console.log("Loaded login page");
  this.fill('form#login', {
    username: username,
    password: password
  }, true);
});

casper.thenEvaluate(function() {
  console.log("Page Title: " + document.title);
});
